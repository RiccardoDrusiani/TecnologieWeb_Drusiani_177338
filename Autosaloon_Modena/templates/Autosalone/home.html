{% load static %}
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Concessionaria - Home</title>
    <link rel="icon" type="image/png" href="{% static 'favicon.png' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/home_custom.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

    <style>
        html, body {
            height: 100%;
        }
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: darkblue;
        }
        main {
            flex: 1;
        }
        .am-logo-favicon {
            font-family: 'Pacifico', cursive;
            font-size: 2.1rem;
            font-weight: bold;
            color: #2563eb;
            background: white;
            border-radius: 50%;
            width: 2.6rem;
            height: 2.6rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px #2563eb33;
            position: absolute;
            left: 0.7rem;
            top: 0.7rem;
            z-index: 1000;
        }
        @media (max-width: 600px) {
            .am-logo-favicon { font-size: 1.3rem; width: 1.7rem; height: 1.7rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-custom d-flex justify-content-between align-items-center px-4 py-2" style="gap: 24px; background-color: darkblue;">
            <h1 class="header-title" style="font-family: 'Pacifico', cursive; font-size:2.7rem; font-weight:900; letter-spacing:2px; color:#fff; text-shadow:2px 2px 8px #1e3a8a, 0 0 12px #2563eb; margin:0;">
                Autosaloon<span style="color:#2563eb;">Modena</span>
            </h1>

            <nav class="d-flex align-items-center" style="gap: 24px; flex-wrap: nowrap;">
                {% if user.is_authenticated %}
                    {% if is_concessionaria %}
                        <a href="{% url 'Auto:user_autos' %}" class="btn btn-outline-light btn-sm d-flex flex-column align-items-center justify-content-center" style="width:70px; height:70px; border-radius:16px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fff" class="bi bi-car-front" viewBox="0 0 16 16">
                                <path d="M4 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm10 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                                <path d="M16 8.5v-1c0-.966-.784-1.75-1.75-1.75h-.805l-.547-2.186A2.5 2.5 0 0 0 10.464 1H5.536a2.5 2.5 0 0 0-2.434 3.564l-.547 2.186h-.805A1.75 1.75 0 0 0 0 7.5v1c0 .456.154.877.414 1.215A2.5 2.5 0 0 0 2 13.5V14a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1h6v1a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-.5a2.5 2.5 0 0 0 1.586-3.785A1.75 1.75 0 0 0 16 8.5zM5.536 2h4.928a1.5 1.5 0 0 1 1.46 1.964l-.5 2H4.58l-.5-2A1.5 1.5 0 0 1 5.536 2zM1 7.5c0-.414.336-.75.75-.75h12.5c.414 0 .75.336.75.75v1a.75.75 0 0 1-.75.75H1.75A.75.75 0 0 1 1 8.5v-1zm1.5 5A1.5 1.5 0 0 1 1.5 11h13a1.5 1.5 0 0 1-1.5 1.5h-10z"/>
                            </svg>
                            <span style="font-size:0.85rem; color: #fff;">Le mie Auto</span>
                        </a>
                        <span style="width:16px;"></span>
                        <a href="#" class="btn btn-outline-light btn-sm d-flex flex-column align-items-center justify-content-center" style="width:70px; height:70px; border-radius:16px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fff" class="bi bi-key" viewBox="0 0 16 16">
                                <path d="M3 8a5 5 0 1 1 9.584 2.5H15a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-1v1a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-1H8.5A5 5 0 0 1 3 8zm5-4a4 4 0 1 0 0 8 4 4 0 0 0 0-8z"/>
                            </svg>
                            <span style="font-size:0.85rem; color: #fff;">Auto Affittate</span>
                        </a>
                        <span style="width:16px;"></span>
                        <a href="#" class="btn btn-outline-light btn-sm d-flex flex-column align-items-center justify-content-center" style="width:70px; height:70px; border-radius:16px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fff" class="bi bi-calendar-check" viewBox="0 0 16 16">
                                <path d="M10.854 8.146a.5.5 0 0 0-.708.708l1 1a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L11.5 8.793l-.646-.647z"/>
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 3v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1h-1v.5a.5.5 0 0 1-1 0V2H4v.5a.5.5 0 0 1-1 0V2H2a1 1 0 0 0-1 1z"/>
                            </svg>
                            <span style="font-size:0.85rem; color: #fff;">Auto Prenotate</span>
                        </a>
                        <span style="width:16px;"></span>
                        <a href="#" class="btn btn-outline-light btn-sm d-flex flex-column align-items-center justify-content-center" style="width:70px; height:70px; border-radius:16px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fff" class="bi bi-handshake" viewBox="0 0 16 16">
                                <path d="M8.354 1.646a.5.5 0 0 1 .707 0l5.293 5.293a.5.5 0 0 1 0 .707l-5.293 5.293a.5.5 0 0 1-.707 0L2.354 7.646a.5.5 0 0 1 0-.707L7.646 1.646a.5.5 0 0 1 .708 0z"/>
                            </svg>
                            <span style="font-size:0.85rem; color: #fff;">Auto in Contrattazione</span>
                        </a>
                    {% elif is_user %}
                        <a href="{% url 'Auto:user_autos' %}" class="btn btn-outline-light btn-sm d-flex flex-column align-items-center justify-content-center" style="width:70px; height:70px; border-radius:16px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fff" class="bi bi-car-front" viewBox="0 0 16 16">
                                <path d="M4 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm10 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                                <path d="M16 8.5v-1c0-.966-.784-1.75-1.75-1.75h-.805l-.547-2.186A2.5 2.5 0 0 0 10.464 1H5.536a2.5 2.5 0 0 0-2.434 3.564l-.547 2.186h-.805A1.75 1.75 0 0 0 0 7.5v1c0 .456.154.877.414 1.215A2.5 2.5 0 0 0 2 13.5V14a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1h6v1a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-.5a2.5 2.5 0 0 0 1.586-3.785A1.75 1.75 0 0 0 16 8.5zM5.536 2h4.928a1.5 1.5 0 0 1 1.46 1.964l-.5 2H4.58l-.5-2A1.5 1.5 0 0 1 5.536 2zM1 7.5c0-.414.336-.75.75-.75h12.5c.414 0 .75.336.75.75v1a.75.75 0 0 1-.75.75H1.75A.75.75 0 0 1 1 8.5v-1zm1.5 5A1.5 1.5 0 0 1 1.5 11h13a1.5 1.5 0 0 1-1.5 1.5h-10z"/>
                            </svg>
                            <span style="font-size:0.85rem; color: #fff;">Le mie Auto</span>
                        </a>
                        <span style="width:16px;"></span>
                        <a href="#" class="btn btn-outline-light btn-sm d-flex flex-column align-items-center justify-content-center" style="width:70px; height:70px; border-radius:16px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fff" class="bi bi-calendar-check" viewBox="0 0 16 16">
                                <path d="M10.854 8.146a.5.5 0 0 0-.708.708l1 1a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L11.5 8.793l-.646-.647z"/>
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 3v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1h-1v.5a.5.5 0 0 1-1 0V2H4v.5a.5.5 0 0 1-1 0V2H2a1 1 0 0 0-1 1z"/>
                            </svg>
                            <span style="font-size:0.85rem; color: #fff;">Auto Affittate/Prenotate</span>
                        </a>
                    {% endif %}
                {% endif %}
                {% if user.is_authenticated %}
                    <div class="dropdown">
                        <a href="#" class="btn btn-link btn-sm text-white fw-bold text-decoration-none dropdown-toggle" id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#fff" class="bi bi-person-circle" viewBox="0 0 16 16">
                                <path d="M13.468 12.37C12.758 11.226 11.383 10.5 8 10.5c-3.383 0-4.758.726-5.468 1.87A6.987 6.987 0 0 0 8 15a6.987 6.987 0 0 0 5.468-2.63z"/>
                                <path fill-rule="evenodd" d="M8 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm5-3a5 5 0 1 1-10 0 5 5 0 0 1 10 0z"/>
                            </svg>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                            <li>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="darkblue" class="bi bi-gear me-2" viewBox="0 0 16 16">
                                        <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                                        <path d="M9.796 1.343c-.527-1.013-1.065-1.012-1.592 0l-.094.187a1.319 1.319 0 0 1-1.255.83c-1.07.09-1.342.507-1.342 1.23v.272c0 .723.272 1.14 1.342 1.23.52.044.98.316 1.255.83l.094.187c.527 1.013 1.065 1.012 1.592 0l.094-.187a1.319 1.319 0 0 1 1.255-.83c1.07-.09 1.342-.507 1.342-1.23v-.272c0-.723-.272-1.14-1.342-1.23a1.319 1.319 0 0 1-1.255-.83l-.094-.187zm-2.633.283c.246-.492.532-.492.778 0l.094.187a2.319 2.319 0 0 0 2.21 1.46c.723.09.995.507.995 1.23v.272c0 .723-.272 1.14-.995 1.23a2.319 2.319 0 0 0-2.21 1.46l-.094.187c-.246.492-.532.492-.778 0l-.094-.187a2.319 2.319 0 0 0-2.21-1.46c-.723-.09-.995-.507-.995-1.23v-.272c0-.723.272-1.14.995-1.23a2.319 2.319 0 0 0 2.21-1.46l.094-.187z"/>
                                    </svg>
                                    Impostazioni
                                </a>
                            </li>
                            <li>
                                <form method="post" action="{% url 'logout' %}" style="display: inline;">
                                    {% csrf_token %}
                                    <button type="submit" class="dropdown-item d-flex align-items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="darkblue" class="bi bi-box-arrow-right me-2" viewBox="0 0 16 16">
                                            <path fill-rule="evenodd" d="M6 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1v-2a.5.5 0 0 1 1 0v2h6V3H7v2a.5.5 0 0 1-1 0V3z"/>
                                            <path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
                                        </svg>
                                        Disconnetti
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </div>
                {% else %}
                    <div class="d-flex align-items-center" style="gap: 12px;">
                        <a href="{% url 'login' %}" class="btn btn-link btn-sm text-white fw-bold text-decoration-none" style="color: white">Accedi</a>
                        <a href="{% url 'register' %}" class="btn btn-link btn-sm text-white fw-bold text-decoration-none" style="color: white">Registrati</a>
                    </div>
                {% endif %}
            </nav>
        </div>
    </header>
    <main class="container-fluid mt-4 d-flex flex-column align-items-center justify-content-center">
        <aside class="d-flex align-items-center justify-content-center w-100" style="min-height: 1px;">
            <div class="filter-section shadow-lg p-4 rounded-5 border-0 bg-white" style="min-width:420px;max-width:900px;width:100%;">
                <form method="get">
                    <div class="row g-3 filter-grid">
                        {% for field in filter.form.visible_fields %}
                            {% if field.name == 'disponibilita' %}
                                <div class="col filter-col">
                                    <label for="{{ field.id_for_label }}" class="form-label filter-label">Disponibilità</label>
                                    {{ field }}
                                </div>
                            {% else %}
                                <div class="col filter-col">
                                    <label for="{{ field.id_for_label }}" class="form-label filter-label">{{ field.label }}</label>
                                    {{ field }}
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <button type="submit" class="btn btn-custom w-100 mt-4 py-3 fs-5 shadow-sm">Applica filtri</button>
                </form>
            </div>
        </aside>
        <section class="col-lg-9 col-md-8 col-12">
            <div class="car-list">
                <div class="card-list">
                    {% for car in cars_page %}
                    <div class="card">
                        {% if car.immagine %}
                            <img src="{{ car.immagine.url }}" class="card-img-top" alt="{{ car.nome }}">
                        {% endif %}
                        <div class="card-body">
                            <h5 class="card-title">{{ car.marca }} {{ car.modello }}</h5>
                            <p class="card-text">Anno: {{ car.anno }}<br>
                                {% with vendita=car.vendita.first %}
                                    {% if vendita %}
                                        Prezzo: €{{ vendita.prezzo_vendita }}<br>
                                    {% endif %}
                                {% endwith %}
                                {% with affitto=car.affitto.first %}
                                    {% if affitto %}
                                        Prezzo Noleggio: €{{ affitto.prezzo_affitto }}/giorno<br>
                                    {% endif %}
                                {% endwith %}
                            </p>
                            <a href="{% url 'Auto:auto-detail' pk=car.id %}?next={{ request.get_full_path }}" class="btn btn-custom">Dettagli</a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </section>
    </main>
    <!-- Nuovo paginator orizzontale, centrato, senza pallini -->
    <nav aria-label="Paginazione auto" class="my-5">
        <div class="d-flex justify-content-center">
            <ul class="paginator-ul">
                {% if cars_page.has_previous %}
                <li>
                    <a class="paginator-link" href="?page={{ cars_page.previous_page_number }}" aria-label="Pagina precedente">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                {% endif %}
                {% for num in cars_page.paginator.page_range %}
                <li>
                    <a class="paginator-link {% if cars_page.number == num %}paginator-link-active{% endif %}" href="?page={{ num }}">{{ num }}</a>
                </li>
                {% endfor %}
                {% if cars_page.has_next %}
                <li>
                    <a class="paginator-link" href="?page={{ cars_page.next_page_number }}" aria-label="Pagina successiva">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
                {% endif %}
            </ul>
        </div>
    </nav>
    <footer>
        <div style="text-align:center;">
            <div style="margin-bottom: 10px;">
                <a href="https://facebook.com" target="_blank" style="margin:0 8px;display:inline-block;">
                    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" alt="Facebook" style="width:32px;height:32px;filter:grayscale(1);">
                </a>
                <a href="https://wa.me/" target="_blank" style="margin:0 8px;display:inline-block;">
                    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WhatsApp" style="width:32px;height:32px;filter:grayscale(1);">
                </a>
                <a href="https://instagram.com" target="_blank" style="margin:0 8px;display:inline-block;">
                    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" alt="Instagram" style="width:32px;height:32px;filter:grayscale(1);">
                </a>
                <a href="mailto:info@autosaloonmodena.it" target="_blank" style="margin:0 8px;display:inline-block;">
                    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/gmail.svg" alt="Gmail" style="width:32px;height:32px;filter:grayscale(1);">
                </a>
                <a href="https://linkedin.com" target="_blank" style="margin:0 8px;display:inline-block;">
                    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/linkedin.svg" alt="LinkedIn" style="width:32px;height:32px;filter:grayscale(1);">
                </a>
            </div>
            <p>
                Copyright © 2025 AutoSalonModena S.p.A., società ad azionista unico sottoposta a direzione e coordinamento da parte della MutinaAutoSalon.<br>
                Tutti i diritti riservati. P.IVA n. ???????????
            </p>
        </div>
    </footer>
<script src="{% static 'bootstrap/js/bootstrap.bundle.min.js' %}"></script>
</body>
</html>